{"version":3,"sources":["assets\\scripts\\start_scene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class start_scene extends cc.Component {\n\n    email_data: string;\n    password_data: string;\n    username: string;\n    uid: string;\n\n    onload() {\n        cc.debug.setDisplayStats(false);\n        if(firebase.auth().currentUser.uid) this.uid = firebase.auth().currentUser.uid;\n    }\n \n    start () {\n        cc.debug.setDisplayStats(false);\n        var count = 4;\n        this.schedule( ()=> {\n            count -= 1;\n            cc.find('background/number').getComponent(cc.Label).string = count.toString();\n        }, 1, 4);\n        this.scheduleOnce(()=> {\n            cc.find('background').active = false;\n        }, 4);\n\n        //cc.audioEngine.playMusic(this.bgm, true);\n\n        this.email_data = \"\";\n        this.password_data = \"\";\n        this.username = \"\";\n\n        var email = new cc.Component.EventHandler();\n        email.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\n        email.component = \"start_scene\"\n        email.handler = \"emailUpdate\";\n        email.customEventData = \"foobar\";\n        cc.find(\"Canvas/Email\").getComponent(cc.EditBox).textChanged.push(email);\n\n        var n = new cc.Component.EventHandler();\n        n.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\n        n.component = \"start_scene\"\n        n.handler = \"nameUpdate\";\n        n.customEventData = \"foobar\";\n        cc.find(\"Canvas/Name\").getComponent(cc.EditBox).textChanged.push(n);\n\n        var password = new cc.Component.EventHandler();\n        password.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\n        password.component = \"start_scene\"\n        password.handler = \"passwordUpdate\";\n        password.customEventData = \"foobar\";\n        cc.find(\"Canvas/Password\").getComponent(cc.EditBox).textChanged.push(password);\n\n        let signin = new cc.Component.EventHandler();\n        signin.target = this.node;\n        signin.component = \"start_scene\";\n        signin.handler = \"loadsignin\";\n        cc.find(\"Canvas/SignIn\").getComponent(cc.Button).clickEvents.push(signin);\n\n        let signup = new cc.Component.EventHandler();\n        signup.target = this.node;\n        signup.component = \"start_scene\";\n        signup.handler = \"loadsignup\";\n        cc.find(\"Canvas/SignUp\").getComponent(cc.Button).clickEvents.push(signup); \n\n    }\n    emailUpdate(text, editbox, customEventData) {\n        this.email_data = text;\n        //console.log(this.email_data);\n    }\n    nameUpdate(text, editbox, customEventData) {\n        this.username = text;\n        //console.log(this.email_data);\n    }\n    passwordUpdate(text, editbox, customEventData) {\n        this.password_data = text;\n    }\n    loadsignin() {\n        //cc.audioEngine.playEffect(this.press, false);\n        firebase.auth().signInWithEmailAndPassword(this.email_data, this.password_data).then( (result) => {\n            firebase.database().ref('/users').once(\"value\").then( (snapshot) => {\n                if(snapshot.child(this.uid).exists() == false) {\n                    var a = {};\n                    var tmp = {};\n                    tmp['coins'] = 0;\n                    tmp['email'] = firebase.auth().currentUser.email;\n                    tmp['highscore'] = 0;\n                    console.log('name = ', this.username)\n                    tmp['name'] = this.username;\n                    var t = {'lego':0, 'banana': 0, 'color': {1: true, 2: false, 3: false, 4: false, 5: false}, 'powerup': 0, 'signal': 0, 'mute': 0}\n                    tmp['thing'] = t;\n                    a[this.uid] = tmp;\n                    firebase.database().ref('/users/').update(a);\n                }\n                this.scheduleOnce(()=>{\n                    \n                    cc.director.loadScene(\"menu\");\n                }, 1);\n            });\n        }).catch(function(error) {\n            alert(error);\n        });\n    }\n    loadsignup() {\n        //cc.audioEngine.playEffect(this.press, false);\n        //console.log(this.email_data, this.password_data);\n        console.log('name = ', this.username);\n        firebase.auth().createUserWithEmailAndPassword(this.email_data, this.password_data).then( (result) => {\n            firebase.database().ref('/users').once(\"value\").then( (snapshot)=> {\n                if(snapshot.child(this.uid).exists() == false) {\n                    var a = {};\n                    var tmp = {};\n                    tmp['coins'] = 0;\n                    tmp['email'] = firebase.auth().currentUser.email;\n                    tmp['highscore'] = 0;\n                    tmp['name'] = this.username;\n                    console.log('name = ', this.username, this.email_data);\n                    var t = {'lego':0, 'banana': 0, 'color': {1:true, 2: false, 3: false, 4: false, 5: false}, 'powerup': 0, 'signal': 0, 'mute': 0}\n                    tmp['thing'] = t;\n                    a[firebase.auth().currentUser.uid] = tmp;\n                    firebase.database().ref('/users/').update(a);\n                    \n                } \n                this.scheduleOnce(()=>{\n                    cc.director.loadScene(\"menu\");\n                }, 1);\n            });\n        }).catch(function(error) {\n            alert(error);\n        });\n    } \n}\n\n\n"]}