{"version":3,"sources":["assets\\scripts\\start_scene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class start_scene extends cc.Component {\r\n\r\n    email_data: string;\r\n    password_data: string;\r\n    username: string;\r\n    uid: string;\r\n\r\n    onload() {\r\n        cc.debug.setDisplayStats(false);\r\n        if(firebase.auth().currentUser.uid) this.uid = firebase.auth().currentUser.uid;\r\n    }\r\n \r\n    start () {\r\n        cc.debug.setDisplayStats(false);\r\n        var count = 4;\r\n        this.schedule( ()=> {\r\n            count -= 1;\r\n            cc.find('background/number').getComponent(cc.Label).string = count.toString();\r\n        }, 1, 4);\r\n        this.scheduleOnce(()=> {\r\n            cc.find('background').active = false;\r\n        }, 4);\r\n\r\n        //cc.audioEngine.playMusic(this.bgm, true);\r\n\r\n        this.email_data = \"\";\r\n        this.password_data = \"\";\r\n        this.username = \"\";\r\n\r\n        var email = new cc.Component.EventHandler();\r\n        email.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        email.component = \"start_scene\"\r\n        email.handler = \"emailUpdate\";\r\n        email.customEventData = \"foobar\";\r\n        cc.find(\"Canvas/Email\").getComponent(cc.EditBox).textChanged.push(email);\r\n\r\n        var n = new cc.Component.EventHandler();\r\n        n.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        n.component = \"start_scene\"\r\n        n.handler = \"nameUpdate\";\r\n        n.customEventData = \"foobar\";\r\n        cc.find(\"Canvas/Name\").getComponent(cc.EditBox).textChanged.push(n);\r\n\r\n        var password = new cc.Component.EventHandler();\r\n        password.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\r\n        password.component = \"start_scene\"\r\n        password.handler = \"passwordUpdate\";\r\n        password.customEventData = \"foobar\";\r\n        cc.find(\"Canvas/Password\").getComponent(cc.EditBox).textChanged.push(password);\r\n\r\n        let signin = new cc.Component.EventHandler();\r\n        signin.target = this.node;\r\n        signin.component = \"start_scene\";\r\n        signin.handler = \"loadsignin\";\r\n        cc.find(\"Canvas/SignIn\").getComponent(cc.Button).clickEvents.push(signin);\r\n\r\n        let signup = new cc.Component.EventHandler();\r\n        signup.target = this.node;\r\n        signup.component = \"start_scene\";\r\n        signup.handler = \"loadsignup\";\r\n        cc.find(\"Canvas/SignUp\").getComponent(cc.Button).clickEvents.push(signup); \r\n\r\n    }\r\n    emailUpdate(text, editbox, customEventData) {\r\n        this.email_data = text;\r\n        //console.log(this.email_data);\r\n    }\r\n    nameUpdate(text, editbox, customEventData) {\r\n        this.username = text;\r\n        //console.log(this.email_data);\r\n    }\r\n    passwordUpdate(text, editbox, customEventData) {\r\n        this.password_data = text;\r\n    }\r\n    loadsignin() {\r\n        //cc.audioEngine.playEffect(this.press, false);\r\n        firebase.auth().signInWithEmailAndPassword(this.email_data, this.password_data).then( (result) => {\r\n            firebase.database().ref('/users').once(\"value\").then( (snapshot) => {\r\n                if(snapshot.child(this.uid).exists() == false) {\r\n                    var a = {};\r\n                    var tmp = {};\r\n                    tmp['coins'] = 0;\r\n                    tmp['email'] = firebase.auth().currentUser.email;\r\n                    tmp['highscore'] = 0;\r\n                    console.log('name = ', this.username)\r\n                    tmp['name'] = this.username;\r\n                    var t = {'lego':0, 'banana': 0, 'color': {1: true, 2: false, 3: false, 4: false, 5: false}, 'powerup': 0, 'signal': 0, 'mute': 0}\r\n                    tmp['thing'] = t;\r\n                    a[this.uid] = tmp;\r\n                    firebase.database().ref('/users/').update(a);\r\n                }\r\n                this.scheduleOnce(()=>{\r\n                    \r\n                    cc.director.loadScene(\"menu\");\r\n                }, 1);\r\n            });\r\n        }).catch(function(error) {\r\n            alert(error);\r\n        });\r\n    }\r\n    loadsignup() {\r\n        //cc.audioEngine.playEffect(this.press, false);\r\n        //console.log(this.email_data, this.password_data);\r\n        console.log('name = ', this.username);\r\n        firebase.auth().createUserWithEmailAndPassword(this.email_data, this.password_data).then( (result) => {\r\n            firebase.database().ref('/users').once(\"value\").then( (snapshot)=> {\r\n                if(snapshot.child(this.uid).exists() == false) {\r\n                    var a = {};\r\n                    var tmp = {};\r\n                    tmp['coins'] = 0;\r\n                    tmp['email'] = firebase.auth().currentUser.email;\r\n                    tmp['highscore'] = 0;\r\n                    tmp['name'] = this.username;\r\n                    console.log('name = ', this.username, this.email_data);\r\n                    var t = {'lego':0, 'banana': 0, 'color': {1:true, 2: false, 3: false, 4: false, 5: false}, 'powerup': 0, 'signal': 0, 'mute': 0}\r\n                    tmp['thing'] = t;\r\n                    a[firebase.auth().currentUser.uid] = tmp;\r\n                    firebase.database().ref('/users/').update(a);\r\n                    \r\n                } \r\n                this.scheduleOnce(()=>{\r\n                    cc.director.loadScene(\"menu\");\r\n                }, 1);\r\n            });\r\n        }).catch(function(error) {\r\n            alert(error);\r\n        });\r\n    } \r\n}\r\n\r\n\r\n"]}